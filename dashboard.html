<script type="module">
    // ...
    function updateNavButtons(user) {
        const authButtonsContainer = document.getElementById('auth-buttons-container');
        if (authButtonsContainer) {
            if (user) {
                const username = user.displayName || user.email;
                authButtonsContainer.innerHTML = `
                    <span class="user-info">مرحباً, ${username.split('@')[0]}!</span>
                    <a href="dashboard.html" class="button cta-button-nav">لوحة التحكم</a>
                    <a href="#" id="logout-button" class="button cta-button-nav">تسجيل الخروج</a>
                `;
                
                // Add active class to dashboard link if on dashboard page
                if (window.location.pathname.includes('dashboard.html')) {
                    document.querySelector('#auth-buttons-container a[href="dashboard.html"]').classList.add('active');
                }

                const logoutButton = document.getElementById('logout-button');
                if (logoutButton) {
                    logoutButton.addEventListener('click', async (e) => {
                        e.preventDefault();
                        try {
                            await signOut(auth);
                            window.location.href = 'index.html';
                        } catch (error) {
                            console.error('فشل تسجيل الخروج:', error);
                        }
                    });
                }
            } else {
                authButtonsContainer.innerHTML = `
                    <a href="signup.html" class="button cta-button-nav">إنشاء حساب جديد</a>
                    <a href="login.html" class="button cta-button-nav">تسجيل الدخول</a>
                `;
            }
        }
    }

    // ...
</script>
